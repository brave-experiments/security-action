rules:
- id: chromium-bind-uaf
  patterns:
    - patterns:
      - pattern-either:
        - pattern: $BASE::BindOnce($...ARGS)
        - pattern: BindOnce($...ARGS)
        - pattern: $BASE::BindRepeating($...ARGS)
        - pattern: BindRepeating($...ARGS)
      - metavariable-comparison:
          comparison: re.match("base::Unretained", str($...ARGS))
  message: 
    BindOnce/BindRepeating may allow callers to access objects which may already be freed in the C++ lifecycle. Verify the occurrences manually
  languages: [cpp, c]
  severity: WARNING

